%table.table.table-bordered
  %tbody
    %tr{:class=>ticket.ticket_type.tr_class}
      %td{colspan:2}
        %h4  
          ="##{ticket.subject}"
    %tr
      %td{style:'width:100px'}  
        = I18n::l(ticket.created_at, :format=>:short)
        - if ticket.requester
          = ticket.requester.name
      %td{rowspan:2}
        = status_label Helpdesk::Ticket::STATUS_BY_KEY[ticket.status.to_sym], Helpdesk::Ticket::STATUS_CLASS_BY_KEY[ticket.status.to_sym]
        = ticket.ticket_type.title

        = simple_format ticket.description
    %tr
      %td
        - if ticket.assignee
          = t('helpdesk.tickets.assignee_to')
          = ticket.assignee.send Helpdesk.display_user.to_sym
    %tr
      %td
        %span.btn.disabled
          = ico('comment') 
          = ticket.comments.pub.size
      %td
        %ul.comments.unstyled
          - ticket.comments.pub.each do |comment|
            - if comment.persisted?
              %li.comment{:id=>"comment#{comment.id}"}
                %div.comment-left
                  - if comment.public
                    = status_label ico('envelope','white') + t('helpdesk.comments.send') ,'label-success'
                  - else
                    = status_label t('helpdesk.comments.note'),''
                  %br
                  %a{class:'anchor', href: "#comment#{comment.id}"}
                    = "#"
                %div.comment-header
                  -if comment.author != ticket.requester
                    = status_label ico('user','white')+ t('helpdesk.comments.helpdesk'),'label-info'
                    
                  = comment.author.name
                  %small
                    = time_ago_in_words(comment.created_at)
                    temu
                %div.comment-body
                  = simple_format comment.comment
  
    %tr{:class=>ticket.ticket_type.tr_class}
      %td{colspan:2}
        - if show_button
          = link_to ticket.subject, ticket_url(ticket), class: 'btn btn-block'
